import{_ as oe,a as ne}from"./Table.db4db060.js";import{a as se}from"./common.8d778571.js";import{a as T,b as re,c as pe}from"./systemManage.169b421f.js";import{d as de,r as _,c as ce,a as ie,b as m,e as s,f as x,g as d,j as a,k as l,u as h,aG as me,aE as _e,F as g,aD as A,h as w,l as v,s as fe,m as ye,t as j,q as L,x as y,E as Ee}from"./index.3926de36.js";import{h as $}from"./moment.9709ab41.js";import{u as N,w as xe}from"./xlsx.86b9426e.js";import"./index.49c99800.js";const he={class:"flex flex-col w-full p-10px box-border",style:{height:"calc(100% - 40px)"}},ve={class:"flex-1 flex flex-col h-100%",style:{"box-shadow":"0px 1px 10px 0px rgba(153, 153, 153, 0.4)"}},Fe=d("div",{class:"h-50px lh-50px pl-10px pr-40px bg-[#F8F8F8]"},[d("span",{class:"text-[#333] text-16px font-bold"},"\u4F01\u4E1A\u5BF9\u8C61\u7BA1\u7406")],-1),be={class:"w-full",style:{height:"calc(100% - 50px)"}},Ce={class:"mt-2px float-right"},Be=y("\u67E5\u8BE2"),ge=y("\u91CD\u7F6E"),Ae={class:"text-right mr-20px mb-10px"},De=y("\u65B0\u589E"),qe=y("\u5BFC\u51FA"),ke={class:"flex justify-center"},we=y("\u67E5\u770B"),Ve=y("\u5220\u9664"),ze={key:0,style:{color:"#f56c6c","margin-right":"4px"}},je={key:0,class:"mt-20px text-right"},Le=y("\u53D6\u6D88"),Ne=y("\u4FDD\u5B58"),Ie=de({__name:"index",setup(Se){const V=_(1),z=_(10),S=_(0),b=_(""),C=_(""),U=()=>{b.value="",C.value="",B()},D=_([]);function O(){se({zdxdm:"qylx"}).then(u=>{D.value=u})}O();const H=[{type:"index",label:"\u5E8F\u53F7",width:"80"},{prop:"qymc",label:"\u4F01\u4E1A\u540D\u79F0",width:240},{slotName:"qylxColumn",type:"slot",label:"\u4F01\u4E1A\u7C7B\u578B"},{prop:"qyjj",label:"\u4F01\u4E1A\u7B80\u4ECB",width:240},{prop:"sshy",label:"\u6240\u5C5E\u884C\u4E1A",width:160},{prop:"tyshxydm",label:"\u4F01\u4E1A\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801",width:200},{slotName:"zcrqColumn",type:"slot",label:"\u4F01\u4E1A\u6CE8\u518C\u65E5\u671F"},{prop:"frdb",label:"\u4F01\u4E1A\u6CD5\u4EBA\u4EE3\u8868"},{prop:"lxdh",label:"\u8054\u7CFB\u7535\u8BDD"},{label:"\u64CD\u4F5C",width:"140",slotName:"actionColumn",type:"slot",align:"center"}],M=_([]),I=ce(()=>u=>{if(u){let e="";return D.value.forEach(n=>{n.dm===u&&(e=n.mc)}),e}return""});function B(){const u={qymcVal:b.value,qylx:C.value,pageNo:V.value,pageSize:z.value};T(u).then(e=>{M.value=e.records,V.value=e.current,z.value=e.size,S.value=e.total})}B();const W=u=>{z.value=u,B()},Z=u=>{V.value=u,B()},G=async()=>{let u=[];const e={qymcVal:b.value,qylx:C.value,pageNo:1,pageSize:5e3};await T(e).then(r=>{u=r.records});const n=[];u.forEach(function(r,c){const k={\u5E8F\u53F7:c+1,\u4F01\u4E1A\u540D\u79F0:r.qymc,\u4F01\u4E1A\u7C7B\u578B:r.qylx,\u4F01\u4E1A\u7B80\u4ECB:r.qyjj,\u6240\u5C5E\u884C\u4E1A:r.sshy,\u4F01\u4E1A\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801:r.tyshxydm,\u4F01\u4E1A\u6CE8\u518C\u65E5\u671F:r.zcrq,\u4F01\u4E1A\u6CD5\u4EBA\u4EE3\u8868:r.frdb,\u8054\u7CFB\u7535\u8BDD:r.lxdh};n.push(k)});const p=N.book_new(),F=N.json_to_sheet(n);N.book_append_sheet(p,F,"sheet"),xe(p,"\u4F01\u4E1A\u5BF9\u8C61\u7BA1\u7406.xlsx"),A({message:"\u5BFC\u51FA\u6210\u529F\uFF01",type:"success"})},E=_(!1),f=_(!0),q=ie([{formLabelText:"",formLabelWidth:"160px",formList:[{prop:"qymc",required:!0,label:"\u4F01\u4E1A\u540D\u79F0",type:"input",value:""},{prop:"qylx",required:!0,label:"\u4F01\u4E1A\u7C7B\u578B",type:"select",value:""},{prop:"qyjj",label:"\u4F01\u4E1A\u7B80\u4ECB",type:"input",value:""},{prop:"sshy",label:"\u6240\u5C5E\u884C\u4E1A",type:"input",value:""},{prop:"tyshxydm",label:"\u4F01\u4E1A\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801",type:"input",value:""},{prop:"zcrq",label:"\u4F01\u4E1A\u6CE8\u518C\u65E5\u671F",type:"date",value:""},{prop:"frdb",label:"\u4F01\u4E1A\u6CD5\u4EBA\u4EE3\u8868",type:"input",value:""},{prop:"lxdh",label:"\u8054\u7CFB\u7535\u8BDD",type:"input",value:""}]}]),Q=()=>{q[0].formList.forEach(u=>{u.value=""}),f.value=!1,E.value=!0},X=()=>{let u=q[0].formList.map(e=>({[e.prop]:e.value}));if(u=u.reduce((e,n)=>{const p=Object.keys(n)[0],F=n[p];return e[p]=F,e},{}),u.qymc){if(!u.qylx)return A.warning("\u8BF7\u9009\u62E9\u4F01\u4E1A\u7C7B\u578B")}else return A.warning("\u8BF7\u586B\u5199\u4F01\u4E1A\u540D\u79F0");re(u).then(e=>{E.value=!1,A.success("\u65B0\u589E\u6210\u529F"),U()}).catch(e=>{E.value=!1,A.error("\u65B0\u589E\u5931\u8D25")})},J=u=>{pe({key:u.id}).then(e=>{for(const n in e)q[0].formList.forEach(p=>{n===p.prop&&(p.value=e[n])});f.value=!0,E.value=!0})},K=()=>{Ee.confirm("\u6682\u65E0\u6743\u9650\u64CD\u4F5C!","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",type:"warning",showCancelButton:!1}).then(()=>{})};return(u,e)=>{const n=m("el-input"),p=m("el-form-item"),F=m("el-option"),r=m("el-select"),c=m("el-button"),k=m("el-form"),P=oe,R=m("el-pagination"),ee=m("el-date-picker"),ue=m("el-col"),le=m("el-row"),te=ne;return s(),x(g,null,[d("div",he,[d("div",ve,[Fe,d("div",be,[a(k,{inline:!0,class:"m-20px pl-30px border-0 border-b border-solid border-#E0E0E0"},{default:l(()=>[a(p,{label:"\u4F01\u4E1A\u540D\u79F0"},{default:l(()=>[a(n,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=t=>b.value=t),modelModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1A\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(p,{label:"\u4F01\u4E1A\u7C7B\u578B"},{default:l(()=>[a(r,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=t=>C.value=t),placeholder:"\u8BF7\u9009\u62E9\u4F01\u4E1A\u7C7B\u578B"},{default:l(()=>[(s(!0),x(g,null,w(D.value,t=>(s(),v(F,{key:t.dm,label:t.mc,value:t.dm},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d("div",Ce,[a(c,{type:"primary",class:"w-80px rounded-15px",icon:h(fe),onClick:B},{default:l(()=>[Be]),_:1},8,["icon"]),a(c,{class:"w-80px bg-[#dceeff] rounded-15px",icon:h(ye),onClick:U},{default:l(()=>[ge]),_:1},8,["icon"])])]),_:1}),d("div",Ae,[a(c,{type:"primary",class:"w-80px rounded-15px",icon:h(me),onClick:Q},{default:l(()=>[De]),_:1},8,["icon"]),a(c,{type:"primary",class:"w-80px rounded-15px",icon:h(_e),onClick:G},{default:l(()=>[qe]),_:1},8,["icon"])]),a(P,{class:"mt-20px",style:{height:"calc(100% - 200px)"},"table-columns":H,"table-data":M.value},{zcrqColumn:l(({row:t})=>[d("span",null,j(t.zcrq&&h($)(t.zcrq).format("YYYY-MM-DD")),1)]),qylxColumn:l(({row:t})=>[d("span",null,j(h(I)(t.qylx)),1)]),actionColumn:l(({row:t})=>[d("div",ke,[a(c,{link:"",type:"primary",onClick:Y=>J(t)},{default:l(()=>[we]),_:2},1032,["onClick"]),a(c,{link:"",type:"danger",onClick:K},{default:l(()=>[Ve]),_:1})])]),_:1},8,["table-data"]),a(R,{class:"justify-end m-10px mt-15px",layout:"total, sizes, prev, pager, next",total:S.value,background:"",onSizeChange:W,onCurrentChange:Z},null,8,["total"])])])]),a(te,{visible:E.value,title:"\u4F01\u4E1A\u5BF9\u8C61\u8BE6\u60C5\u67E5\u770B",width:"1000px",onClose:e[3]||(e[3]=t=>E.value=!1)},{default:l(()=>[(s(!0),x(g,null,w(q,(t,Y)=>(s(),v(k,{key:Y,"label-width":t.formLabelWidth},{default:l(()=>[a(le,{gutter:0},{default:l(()=>[(s(!0),x(g,null,w(t.formList,(o,ae)=>(s(),v(ue,{key:ae,span:o.span||12},{default:l(()=>[a(p,null,{label:l(()=>[o.required&&!f.value?(s(),x("span",ze,"*")):L("",!0),d("span",null,j(o.label),1)]),default:l(()=>[o.type==="input"?(s(),v(n,{key:0,modelValue:o.value,"onUpdate:modelValue":i=>o.value=i,modelModifiers:{trim:!0},type:o.type,disabled:f.value},null,8,["modelValue","onUpdate:modelValue","type","disabled"])):o.type==="date"?(s(),v(ee,{key:1,modelValue:o.value,"onUpdate:modelValue":i=>o.value=i,style:{width:"100%"},type:"date",disabled:f.value,onChange:i=>o.value=h($)(o.value).format("YYYY-MM-DD HH:mm:ss")},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])):o.prop==="qylx"?(s(),v(r,{key:2,modelValue:o.value,"onUpdate:modelValue":i=>o.value=i,style:{width:"100%"},disabled:f.value,placeholder:f.value?" ":"\u8BF7\u9009\u62E9"},{default:l(()=>[(s(!0),x(g,null,w(D.value,i=>(s(),v(F,{key:i.dm,label:i.mc,value:i.dm},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","placeholder"])):L("",!0)]),_:2},1024)]),_:2},1032,["span"]))),128))]),_:2},1024)]),_:2},1032,["label-width"]))),128)),f.value?L("",!0):(s(),x("div",je,[a(c,{class:"w-80px h-40px",onClick:e[2]||(e[2]=t=>E.value=!1)},{default:l(()=>[Le]),_:1}),a(c,{type:"primary",class:"w-80px h-40px",onClick:X},{default:l(()=>[Ne]),_:1})]))]),_:1},8,["visible"])],64)}}});export{Ie as default};
